{#
  kitFramework

  @author Team phpManufaktur <team@phpmanufaktur.de>
  @link https://kit2.phpmanufaktur.de
  @link https://github.com/phpManufaktur/kitFramework/wiki
  @copyright 2013 Ralf Hertsch <ralf.hertsch@phpmanufaktur.de>
  @license MIT License (MIT) http://www.opensource.org/licenses/MIT
#}
{% if usage|default('framework') == 'framework' %}
  {% set template_file = 'framework/body.twig' %}
{% else %}
  {% set template_file = 'framework/backend.body.twig' %}
{% endif %}
{% extends getTemplateFile('@phpManufaktur/Basic/Template', template_file) %}
{% block title %}{{ 'kitFramework - First Login'|trans }}{% endblock %}
{% block content %}
  <div class="container">
    <div class="page-header">
      <h1>{{ 'Login'|trans }} <small>kitFramework</small></h1>
    </div>
    
    {{ alert }}
    
    {% if alert|length == 0 %}
      <div class="alert alert-info">
        {% if app.translator.locale == 'de' %}
          {# GERMAN language #}
          <p>Hallo {{ form.display_name.vars.value }},</p>
          <p>sie rufen das kitFramework zum ersten Mal auf.</p>
          <p>Sie sind bereits in {{ usage }} eingeloggt. Damit Sie künftig automatisch mit Ihrem Konto am kitFramework angemeldet werden können, müssen Sie einmalig Ihr Passwort eingeben.</p>
        {% else %}
          {# ENGLISH language #}
          <p>Hello {{ form.display_name.vars.value }},</p>
          <p>this is the first time you are executing the kitFramework.</p>
          <p>You are already logged in  at {{ usage }}. To enable a auto-login into the kitFramework you must authenticate with your password only one times.</p>
        {% endif %}
      </div>
    {% endif %}
    
    <form action="{{ FRAMEWORK_URL }}/login/first/cms/check?usage={{ usage }}" method="post" {{ form_enctype(form) }}>
      {{ form_errors(form) }}
      {{ form_row(form._token) }}
      
      {{ form_row(form.usage) }}
      {{ form_row(form.username) }}
      {{ form_row(form.email) }}
      {{ form_row(form.display_name) }}
      {{ form_row(form.redirect) }}
      {{ form_row(form.auto_login) }}
      {{ form_row(form.roles) }}
      {{ form_row(form.secured_area) }}
      
      <div class="row">
        <label class="col-lg-2 {% if form.name.vars.required %}required{% endif %}" for="{{ form.name.vars.id }}">{{ form.name.vars.label|trans }}</label>
        {{ form_widget(form.name, {'attr':{'class':'col-lg-2'}}) }}
      </div>
      
      <div class="row">
        <label class="col-lg-2 {% if form.password.vars.required %}required{% endif %}" for="{{ form.password.vars.id }}">{{ form.password.vars.label|trans }}</label>
        {{ form_widget(form.password, {'attr':{'class':'col-lg-2'}}) }}
      </div>
      
      <div class="row">
        <label class="col-lg-2"></label>
        <input class="col-lg-2" type="submit" name="submit" />
      </div>
    </form>
  </div>
{% endblock %}
{% block footer %}
  {{ parent() }}
  <script type="text/javascript">
    if (typeof 'jQuery' !== 'undefined') {
      $(document).ready(function() {
        {# set focus to the password field #}
        $('input[id=form_password]').focus();
      });
    }
  </script>
{% endblock footer %}
